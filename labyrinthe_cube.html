<!DOCTYPE html>
<html lang="fr">

<head>
	<meta charset="cp1252">
	<title>Cube 3D minimal</title>
	<style>
		body {
			font-family: Arial;
			margin: 0;
			padding: 20px;
			display: flex;
			flex-direction: column;
			align-items: center
		}

		#grid {
			display: grid;
			gap: 2px;
			margin: 20px 0
		}

		.cell {
			width: 24px;
			height: 24px;
			border: 1px solid #999;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 14px
		}

		.empty {
			background: #eee
		}

		.wall {
			background: #444
		}

		.player {
			background: #2a9;
			border: 2px solid #000
		}

		.goal {
			background: #c22;
			color: #fff
		}
	</style>
</head>

<body>
	<p id="description">
		Ce jeu affiche un labyrinthe en trois dimensions dans un cube de taille N×N×N.
		Le joueur se déplace librement dans l’espace (flèches pour X-Y, Q et A pour changer de couche Z)
		et doit atteindre la case but.
		Un curseur (slider) permet de faire défiler les coupes horizontales pour comprendre la structure interne du cube ;
		chaque couche révèle murs, couloirs, obstacles et énigmes.
		L’objectif est de résoudre ces défis et de rejoindre la case centrale (ou toute autre position définie comme but)
		en tenant compte des contraintes spatiales imposées par le labyrinthe en 3D.
	</p>

	<label>Couche Z : <input id="slider" type="range" min="0" max="4" value="0"></label>
	<div id="grid"></div>
	<p>Déplacement : flèches (XY), Q (haut), A (bas)</p>

	<script>
		const N = 5;
		const EMPTY = 0, WALL = 1, PLAYER = 2, GOAL = 3;

		// Génère un cube aléatoire avec murs (30 %) puis place joueur et but
		function generateCube() {
			const cube = Array.from({length: N}, () => Array.from({length: N}, () => Array(N).fill(EMPTY)));
			for (let z = 0; z < N; z++)for (let y = 0; y < N; y++)for (let x = 0; x < N; x++) {
				if (Math.random() < 0.3) cube[z][y][x] = WALL;
			}
			cube[0][0][0] = PLAYER;
			cube[N - 1][N - 1][N - 1] = GOAL;
			return cube;
		}

		let cube = generateCube();
		let player = {x: 0, y: 0, z: 0};

		const slider = document.getElementById("slider");
		const grid = document.getElementById("grid");
		grid.style.gridTemplateColumns = `repeat(${N}, 24px)`;

		function render() {
			const z = parseInt(slider.value, 10);
			grid.innerHTML = "";
			for (let y = 0; y < N; y++)for (let x = 0; x < N; x++) {
				const v = cube[z][y][x];
				const cell = document.createElement("div");
				cell.className = "cell " + (v === EMPTY ? "empty" : v === WALL ? "wall" : v === PLAYER ? "player" : "goal");
				grid.appendChild(cell);
			}
		}

		function move(dx, dy, dz) {
			const nx = player.x + dx, ny = player.y + dy, nz = player.z + dz;
			if (nx < 0 || ny < 0 || nz < 0 || nx >= N || ny >= N || nz >= N) return;
			if (cube[nz][ny][nx] === WALL) return;
			cube[player.z][player.y][player.x] = EMPTY;
			player = {x: nx, y: ny, z: nz};
			if (cube[nz][ny][nx] === GOAL) {alert("Bravo, but atteint !"); cube = generateCube(); player = {x: 0, y: 0, z: 0}; slider.value = 0;}
			cube[player.z][player.y][player.x] = PLAYER;
			slider.value = player.z;
			render();
		}

		document.addEventListener("keydown", e => {
			if (e.key === "ArrowUp") move(0, -1, 0);
			else if (e.key === "ArrowDown") move(0, 1, 0);
			else if (e.key === "ArrowLeft") move(-1, 0, 0);
			else if (e.key === "ArrowRight") move(1, 0, 0);
			else if (e.key === "q" || e.key === "Q") move(0, 0, -1);
			else if (e.key === "a" || e.key === "A") move(0, 0, 1);
		});

		slider.addEventListener("input", render);
		render();
	</script>

</body>

</html>
